import unittest
import re


class SimplePostalValidator:

    @staticmethod
    def find_in_text(text: str, strict: bool = False) -> list:
        pattern = r'\b[1-9]\d{5}\b' if strict else r'\b\d{6}\b'
        return re.findall(pattern, text)

    @staticmethod
    def validate_postal_code(code: str, strict: bool = False) -> tuple:
        code = code.strip()

        if not re.fullmatch(r'\d{6}', code):
            return False, "Индекс должен состоять из 6 цифр"

        if strict and not re.fullmatch(r'[1-9]\d{5}', code):
            return False, "Первая цифра индекса не может быть 0"

        return True, "Корректный российский почтовый индекс"


class TestSimplePostalValidator(unittest.TestCase):

    def test_find_in_text(self):
        text = "Адреса: 101000 Москва, 190000 СПб, 12345 невалидный"
        result = SimplePostalValidator.find_in_text(text)
        self.assertEqual(result, ['101000', '190000'])

    def test_validate_postal_code(self):
        self.assertTrue(SimplePostalValidator.validate_postal_code('101000')[0])
        self.assertTrue(SimplePostalValidator.validate_postal_code('190000')[0])

        self.assertFalse(SimplePostalValidator.validate_postal_code('12345')[0])
        self.assertFalse(SimplePostalValidator.validate_postal_code('abcdef')[0])

    def test_strict_mode(self):
        result = SimplePostalValidator.find_in_text("012345 101000", strict=True)
        self.assertEqual(result, ['101000'])

        result = SimplePostalValidator.find_in_text("012345 101000", strict=False)
        self.assertEqual(result, ['012345', '101000'])


def run_all_tests():
    print("Запуск тестов для проверки почтовых индексов")
    print("=" * 50)

    loader = unittest.TestLoader()
    suite = loader.loadTestsFromTestCase(TestSimplePostalValidator)

    runner = unittest.TextTestRunner(verbosity=2)
    result = runner.run(suite)

    print("=" * 50)
    if result.wasSuccessful():
        print("Все тесты пройдены успешно!")
    else:
        print("Есть проблемы с тестами")

    return result.wasSuccessful()


if __name__ == "__main__":
    success = run_all_tests()

    exit(0 if success else 1)
